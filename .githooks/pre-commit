#!/bin/bash
# Pre-commit hook for monorepo validation

echo "üîç Running pre-commit checks..."

# Check for .env files
if git diff --cached --name-only | grep -q "\.env$"; then
    echo "‚ùå ERROR: .env files cannot be committed"
    exit 1
fi

# Check for debugger statements
if git diff --cached | grep -q "debugger"; then
    echo "‚ùå ERROR: debugger statements found"
    exit 1
fi

# Check project isolation
ARGO_CHANGED=false
ALPINE_CHANGED=false

for file in $(git diff --cached --name-only); do
    if [[ "$file" == argo/* ]]; then
        ARGO_CHANGED=true
    elif [[ "$file" == alpine-backend/* ]] || [[ "$file" == alpine-frontend/* ]]; then
        ALPINE_CHANGED=true
    fi
done

if [ "$ARGO_CHANGED" = true ] && [ "$ALPINE_CHANGED" = true ]; then
    echo "‚ö†Ô∏è  WARNING: Changes in both argo and alpine projects"
    echo "Consider splitting into separate commits"
fi

echo "‚úÖ Pre-commit checks passed"
exit 0
